<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Admin Control</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="./javascripts/admins.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.6.4/firebase.js"></script>
    <script src="./javascripts/db.js"></script>
    <script type="text/javascript">
        var config = {
            apiKey: "AIzaSyBqY_bejkW_TikSZSBUKuE4JH1EU74xYGI",
            authDomain: "chicktrucksales.firebaseapp.com",
            databaseURL: "https://chicktrucksales.firebaseio.com",
            storageBucket: "chicktrucksales.appspot.com",
            messagingSenderId: "585030817418"
        };
//        var app = firebase.initializeApp(config);


        $(document).ready(function () {
            firebase.auth().onAuthStateChanged(function(user) {
                if(user){
                    var isAdmin = false;
                    for(i = 0; i<admins.length;i++){
                        if(user.uid === admins[i]){
                            console.log("an admin was authenticated");
                            console.log(user.uid);
                            isAdmin = true;
                        }
                    }

                    if(!isAdmin){
                        console.log("a non-admin authenticated and was denied");
                        window.location.assign("./denied.html");
                    }
                }else{
                    console.log("a user visited this page unauthenticated");
                    window.location.assign("./auth.html");
                }

            });
        });
    </script>

    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>


</head>
<body><!-- Always shows a header, even in smaller screens. -->
<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
    <header class="mdl-layout__header">
        <div class="mdl-layout__header-row">
            <!-- Title -->
            <span class="mdl-layout-title">Admin Page</span>
            <!-- Add spacer, to align navigation to the right -->
            <div class="mdl-layout-spacer"></div>
            <!-- Navigation. We hide it in small screens. -->
            <nav class="mdl-navigation">
                <!--<a class="mdl-navigation__link" href="">Link</a>-->
                <!--<a class="mdl-navigation__link" href="">Link</a>-->
                <!--<a class="mdl-navigation__link" href="">Link</a>-->
                <a class="mdl-navigation__link" href="./">Home</a>
            </nav>
        </div>
    </header>
    <main class="mdl-layout__content">
        <div class="page-content">
            <form action="#">
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                    <input class="mdl-textfield__input" type="text" id="make">
                    <label class="mdl-textfield__label" for="make">Make</label>
                </div>
            </form>
            <form action="#">
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                    <input class="mdl-textfield__input" type="text" id="model">
                    <label class="mdl-textfield__label" for="model">Model</label>
                </div>
            </form>
            <form action="#">
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                    <input class="mdl-textfield__input" type="text" id="year">
                    <label class="mdl-textfield__label" for="year">Year</label>
                </div>
            </form>
            <form action="#">
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                    <input class="mdl-textfield__input" type="text" id="miles">
                    <label class="mdl-textfield__label" for="miles">Miles</label>
                </div>
            </form>
            <form action="#">
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                    <input class="mdl-textfield__input" type="text" id="color">
                    <label class="mdl-textfield__label" for="color">Color</label>
                </div>
            </form>

            <form action="#">
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                    <textarea class="mdl-textfield__input" type="text" rows= "3" id="comments" ></textarea>
                    <label class="mdl-textfield__label" for="comments">Comments</label>
                </div>
            </form>

            <form action="#">
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                    <input class="mdl-textfield__input" type="text" id="price">
                    <label class="mdl-textfield__label" for="price">Price</label>
                </div>
            </form>


            <button class="mdl-button mdl-js-button mdl-button--raised button">
                Add Car
            </button>
            <br>
            <br>
            <br>
            <br>

            <button class="mdl-button mdl-js-button mdl-button--raised delete">
                Delete A Car
            </button>
            <div class="deleteDiv" style="display: none">

            </div>

            <form action="#">
                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                    <textarea class="mdl-textfield__input" type="text" rows= "3" id="message" ></textarea>
                    <label class="mdl-textfield__label" for="message">Edit Message Of The Day</label>
                </div>
            </form>

            <button class="mdl-button mdl-js-button mdl-button--raised motd">
                Update MOTD
            </button>


        </div>
    </main>
</div>

</body>

<script class="mainJS">
    function capitalizeFirstLetter(string) {
        var lower = string.toLowerCase();
//        console.log("lower " + lower);
        return lower.charAt(0).toUpperCase() + lower.slice(1);
    }

    $(".button").click(function () {
        var make1 = $("#make").val();

        console.log(make1);
        var model1 = $("#model").val();
        console.log(model1);
        var color1 = $("#color").val();
        console.log(color1);
        var comments1 = $("#comments").val();
        console.log(comments1);
        var price1 = $("#price").val();
        console.log(price1);
        var year1 = $("#year").val();
        console.log(price1);
        var miles1 = $("#miles").val();
        console.log(miles);

        if(make1 === "" || model1 === ""){
            alert("You cannot submit a car with a blank make/model field");

        }else {

//        if($(".color").val().toLowerCase() === $(".color").val()){
//        }else{
            data.color = color1;
            data.name = make1 + " " + model1;
            data.make = make1;
            data.model = model1;
            data.comments = comments1;
            data.price = price1;
            data.year = year1;
            data.miles = miles1;

            console.log(data);
            writeDb();
            $("#make").val("").select();
            $("#model").val("");
            $("#color").val("");
            $("#comments").val("");
            $("#price").val("");
            $("#year").val("");
            $("#miles").val("");
            $("main").append("<h6 style='color: green' class='successMsg'>Submitted!</h6>");
            setTimeout(function () {
                $(".successMsg").remove();
            }, 1000);
//        }
        }
    });

    $(".delete").click(function () {
        $(".deleteDiv").css("display", "block");
    });
    $(".motd").click(function () {
        msgRef.remove();
        motd.message = $("#message").val();
        writeMOTD();
        $("#message").val("");
        alert("Posted new message of the day");
    });



    $(document).keydown(function (e) {
        if(e.keyCode === 192){
            $("main").prepend('<form action="#"> <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"> <input class="mdl-textfield__input" type="text" id="image"> <label class="mdl-textfield__label" for="image">Image</label> </div> </form>');
            setTimeout(function () {
                $(document).keydown(function (e) {
                    if(e.keyCode === 178){
                        data.image = $("#image").val();
                        alert(data.image);
                        alert($("#image").val());
                    }
                });
            });

        }
    });
</script>
<style>
    main{
        text-align: center;
        background-color: #fafafa;
    }
    #delCar:hover{
        color: red;
        cursor: pointer;
    }
</style>

</html>